<apex:page controller="FindDoctorController" sidebar="False" title="Find Doctor" showHeader="False" docType="HTML - 5.0">
    <apex:form >
        <apex:sectionHeader title="Find a doctor" />
        <apex:pageBlock rendered="{!displayCriteria}">
        <!--Choose Sex picklst-->
            <apex:pageBlockSection id="getMaxDistance" title="What is the furthest you are willing to travel (in miles)?">
                <apex:inputText value="{!maxDistance}"/>
            </apex:pageBlockSection>
            <apex:pageBlockSection title="Select a preferred sex" collapsible="False">
                <apex:selectList id="chooseSex" value="{!selectedSex}" multiselect="false" size = "1">
                    <apex:selectOption itemValue="No Preference" itemLabel="No Preference"/>
                    <apex:selectOption itemValue="Male" itemLabel="Male"/>
                    <apex:selectOption itemValue="Female" itemLabel="Female"/>
                </apex:selectList>
            </apex:pageBlockSection>
            <!--Choose language picklist-->
            <apex:pageBlockSection title="Select a preffered language" collapsible="False">
                <apex:selectList id="chooseLanguage" value="{!selectedLanguage}" multiselect="false" size = "1">
                    <apex:selectOption itemValue="English" itemLabel="English"/>
                    <apex:selectOption itemValue="Spanish" itemLabel="Spanish"/>
                    <apex:selectOption itemValue="Chinese" itemLabel="Chinese"/>
                </apex:selectList>
            </apex:pageBlockSection>
            <!--Choose specialty picklist-->
            <apex:PageBlockSection title="Select a preferred specialty" collapsible="False">
                <apex:selectList id="chooseSpecialty" value="{!selectedSpecialty}" multiselect="false" size = "1">
                    <apex:selectOption itemValue="Cancer" itemLabel="Cancer"/>
                    <apex:selectOption itemValue="Heart Failure" itemLabel="Heart Failure"/>
                </apex:selectList>
            </apex:PageBlockSection>
            <!--Choose Date option -->
            <apex:pageBlockSection title="Select a date" collapsible="False">
                <apex:input value="{!selectedDate}" type="date"/>
            </apex:pageBlockSection>
            <apex:pageBlockButtons location="bottom">
                <apex:commandButton action="{!searchDoctors}" value="Find Doctors"/>
            </apex:pageBlockButtons>
        </apex:pageBlock>
        <apex:pageBlock rendered="{!displayDoctorTable}" id="chooseDoctor">
            <apex:pageBlockSection title="Choose a doctor" collapsible="False">
                <apex:pageBlockTable id="doctorTable" value="{!doctorsToShow}" var="docs">
                    <apex:column value="{!docs.name}"/>
                    <apex:column value="{!docs.Languages__c}"/>
                    <apex:column value="{!docs.Sex__c}"/>
                    
                    <apex:column headerValue="Select this doctor?">
                        <apex:commandLink value="Select" action="{!searchAvailableAppointments}" >
                            <apex:param name="selectedDoctor" value="{!docs.id}" assignTo="{!selectedDoctorID}" />
                        </apex:commandLink>
                    </apex:column>
                </apex:pageBlockTable>  
            </apex:pageBlockSection>
        </apex:pageBlock>
        <apex:pageBlock rendered="{!displayAppointmentTable}">
            <apex:pageBlockSection title="Select Appointment" collapsible="False">
                <apex:pageBlockTable id="appointmentTable" value="{!availableTimes}" var="times">
                    <apex:column value="{!times.dt}"/>
                    <apex:column headerValue="Select this appointment?" >
                        <apex:commandLink value="Select" action="{!selectAppointment}" >
                            <apex:param name="selectedAppointment" value="{!times.dt }" assignTo="{!selectedStartTime}"/>
                        </apex:commandLink>
                    </apex:column>
                </apex:pageBlockTable>                         
            </apex:pageBlockSection>
        </apex:pageBlock>
        <apex:pageBlock rendered="{!displayAppointmentInfo}">
            <apex:pageBlockSection title="Select the appointment type" collapsible="false">
                <apex:selectList id="chooseType" value="{!appointmentType}" multiselect="false" size = "1">
                    <apex:selectOption itemValue="Check-up" itemLabel="Check-up"/>
                    <apex:selectOption itemValue="Consulation" itemLabel="Consulation"/>
                    <apex:selectOption itemValue="Lab test" itemLabel="Lab test"/>
                    <apex:selectOption itemValue="Treatment" itemLabel="Treatment"/>
                </apex:selectList>
            </apex:pageBlockSection>
            <apex:pageBlockSection title="Appointment Information" collapsible="True">
                <apex:outputLabel value="Doctor Name ">
                    <apex:outputText value="{!selectedDoctor.name}"/>
                </apex:outputLabel>
                <apex:outputText value="{0, date, MM/dd/yyyy ' at ' HH:mm a}">
                    <apex:param value = "{!appointmentToSave.Start_Time__c}"/>
                </apex:outputText>
            </apex:pageBlockSection>  
            <apex:pageBlockButtons location="bottom" >
                <apex:commandButton action="{!closeAppointment}" value="Close this appointment"/>
                <apex:commandButton action="{!saveAppointment}" value="Request Appointment"/>
            </apex:pageBlockButtons>
        </apex:pageBlock>
        <apex:pageBlock >
            <apex:pageBlockButtons location="Bottom">
                <apex:commandButton value="Restart Search" action="{!restartSearch}"/>
            </apex:pageBlockButtons>
        </apex:pageBlock>
    </apex:form>
</apex:page>
